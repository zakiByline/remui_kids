# Emulator Access Control - Complete Workflow Guide

## Navigation Flow

This guide shows the complete workflow for managing emulator access across the system.

---

## ğŸ¯ Global Admin Workflow

### **Starting Point: Emulator Access Control Page**

Navigate to: **Site Administration â†’ IOMAD Dashboard â†’ Emulator Access Control**

You'll see **two tabs:**
1. **School Grants** - Control which emulators are available to which schools
2. **Access Control** - Configure detailed teacher/student/cohort permissions

---

### **Workflow A: Quick School Grants**

```
1. Click "School Grants" tab
   â†“
2. Select a school from dropdown
   â†“
3. Toggle switches ON/OFF for each emulator
   â†“
4. âœ… Grants save automatically
   â†“
5. Repeat for other schools
```

**Use Case:** Quick bulk granting of emulators to schools

---

### **Workflow B: Grant + Configure Access**

```
1. Click "School Grants" tab
   â†“
2. Select a school from dropdown
   â†“
3. Find the emulator card you want to configure
   â†“
4. Toggle switch ON to grant the emulator
   â†“
5. Click "Access Control" button on that card
   â†“
6. [Auto-switches to Access Control tab]
   â†“
7. Configure detailed settings:
   - School-wide teacher access
   - School-wide student access
   - Cohort-specific overrides
   - Individual teacher selection
   â†“
8. Click "Back to School Grants" to return
```

**Use Case:** Grant emulator AND configure detailed permissions in one flow

---

## ğŸ« School Manager Workflow

### **Starting Point: School Manager Dashboard**

Navigate to: **School Manager â†’ Emulator Access**

**What You See:**
- Only emulators **granted to your school** by the global admin
- If no emulators: "No Emulators Available" message

---

### **Managing Access:**

```
1. Select an emulator from left sidebar
   â†“
2. Configure in right panel:
   â”œâ”€ SCHOOL-WIDE ACCESS
   â”‚  â”œâ”€ Teachers: Enable/Disable
   â”‚  â””â”€ Students: Enable/Disable
   â”‚
   â”œâ”€ INDIVIDUAL TEACHERS (NEW!)
   â”‚  â”œâ”€ Toggle for each teacher
   â”‚  â””â”€ Teacher name + email shown
   â”‚
   â””â”€ COHORT OVERRIDES
      â”œâ”€ Override for specific cohorts
      â””â”€ Separate controls for teachers/students
   â†“
3. Changes save automatically
   â†“
4. Select another emulator to configure
```

---

## ğŸ“Š Complete Access Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LEVEL 1: Global Admin (School Grants)              â”‚
â”‚                                                      â”‚
â”‚ School Grants Tab                                   â”‚
â”‚ â”œâ”€ Select School                                    â”‚
â”‚ â”œâ”€ Toggle: Grant/Deny Emulator                     â”‚
â”‚ â””â”€ Click "Access Control" button (optional)        â”‚
â”‚    â†“                                                 â”‚
â”‚    [Navigates to Access Control tab]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LEVEL 2: Global Admin (Access Control)             â”‚
â”‚                                                      â”‚
â”‚ Access Control Tab                                  â”‚
â”‚ â”œâ”€ Select School                                    â”‚
â”‚ â”œâ”€ Select Emulator (auto-selected if from grants)  â”‚
â”‚ â”œâ”€ School-Wide: Teachers ON/OFF                    â”‚
â”‚ â”œâ”€ School-Wide: Students ON/OFF                    â”‚
â”‚ â”œâ”€ Individual Teachers: Select specific teachers   â”‚
â”‚ â””â”€ Cohort Overrides: Per-cohort permissions        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LEVEL 3: School Manager (Emulator Access)          â”‚
â”‚                                                      â”‚
â”‚ School Manager Dashboard â†’ Emulator Access          â”‚
â”‚ â”œâ”€ View ONLY granted emulators                     â”‚
â”‚ â”œâ”€ Select emulator from sidebar                    â”‚
â”‚ â”œâ”€ Configure school-wide access                    â”‚
â”‚ â”œâ”€ Select individual teachers                      â”‚
â”‚ â””â”€ Configure cohort overrides                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Navigation Paths

### **Path 1: School Grants â†’ Access Control**

```
School Grants Tab
â””â”€ Click "Access Control" button on a card
   â””â”€ Access Control Tab opens
      â”œâ”€ Emulator pre-selected
      â”œâ”€ School pre-selected
      â”œâ”€ "Back to School Grants" button appears
      â””â”€ Context banner shows which emulator
```

### **Path 2: Access Control â†’ School Grants**

```
Access Control Tab
â””â”€ Click "Back to School Grants" button
   â””â”€ School Grants Tab opens
      â”œâ”€ School remains selected
      â””â”€ All emulator cards shown
```

### **Path 3: Direct Access Control**

```
Access Control Tab (default view)
â”œâ”€ Select school from dropdown
â”œâ”€ Select emulator from sidebar
â””â”€ Configure permissions
```

---

## ğŸ¨ UI Components

### **School Grants Tab:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SELECT SCHOOL                           â”‚
â”‚ [Al-Faisaliah Islamic School     â–¼]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [</>]    â”‚  â”‚ [ğŸ§©]     â”‚  â”‚ [âš¡]     â”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ Code     â”‚  â”‚ Scratch  â”‚  â”‚ SQL Lab  â”‚
â”‚ Editor   â”‚  â”‚ Emulator â”‚  â”‚          â”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ âœ“Granted â”‚  â”‚ âœ—Denied  â”‚  â”‚ âœ“Granted â”‚
â”‚ [â—â”€â”€] ON â”‚  â”‚ [â”€â”€â—‹] OFFâ”‚  â”‚ [â—â”€â”€] ON â”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ [Access  â”‚  â”‚ [Access  â”‚  â”‚ [Access  â”‚
â”‚  Control]â”‚  â”‚  Control]â”‚  â”‚  Control]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Access Control Tab (from grants):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â† Back to School Grants]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [</>] Configuring: Code Editor          â”‚
â”‚ Judge0-based IDE with multi-language... â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SCHOOL-WIDE ACCESS
â”œâ”€ Teachers: [ENABLED] â˜‘ [Reset]
â””â”€ Students: [DISABLED] â˜ [Reset]

INDIVIDUAL TEACHERS
â”œâ”€ John Doe: [ENABLED] â˜‘
â”œâ”€ Jane Smith: [DISABLED] â˜
â””â”€ Bob Teacher: [ENABLED] â˜‘

COHORT OVERRIDES
â”œâ”€ Grade 5: Teachers â˜‘ | Students â˜
â””â”€ Grade 6: Teachers â˜‘ | Students â˜‘
```

---

## ğŸ’¡ Use Case Examples

### **Example 1: Quick Grant to Multiple Schools**

**Goal:** Grant "Code Editor" to 10 schools quickly

**Steps:**
1. School Grants tab
2. Select School 1 â†’ Toggle Code Editor ON
3. Select School 2 â†’ Toggle Code Editor ON
4. Repeat for all 10 schools
5. âœ… Done - All schools have access

---

### **Example 2: Grant + Fine-Tune Access**

**Goal:** Grant "Scratch" to School A, but only for Grade 1-3 students

**Steps:**
1. School Grants tab
2. Select School A
3. Toggle "Scratch Emulator" ON
4. Click "Access Control" button on Scratch card
5. [Navigates to Access Control]
6. School-Wide Students: Keep DISABLED
7. Cohort Overrides:
   - Grade 1: Students ON
   - Grade 2: Students ON
   - Grade 3: Students ON
   - Other grades: Leave OFF
8. Click "Back to School Grants"
9. âœ… Done - Only Grade 1-3 students have access

---

### **Example 3: Teacher-Specific Access**

**Goal:** Grant "SQL Lab" to School B, but only for specific teachers

**Steps:**
1. School Grants tab
2. Select School B
3. Toggle "SQL Lab" ON
4. Click "Access Control" button on SQL Lab card
5. [Navigates to Access Control]
6. School-Wide Teachers: Keep DISABLED
7. Individual Teachers:
   - John (Database Expert): Enable â˜‘
   - Jane (IT Teacher): Enable â˜‘
   - Bob (Math Teacher): Leave disabled â˜
8. School-Wide Students: Enable â˜‘ (all students can access)
9. âœ… Done - Only John and Jane (teachers) can access, all students can

---

## ğŸ¯ Benefits of This Workflow

âœ… **Fast Grants** - Toggle switches for quick school grants  
âœ… **Deep Configuration** - Access Control button for detailed setup  
âœ… **Context Preservation** - School and emulator selection maintained  
âœ… **Easy Navigation** - Back button to return to grants view  
âœ… **Visual Feedback** - Context banner shows which emulator being configured  
âœ… **Flexible** - Choose between quick grants or detailed configuration  

---

## ğŸ”‘ Key Features

### **On Emulator Cards:**
- **Toggle Switch** - Quick grant/deny
- **Access Control Button** - Deep configuration
- **Status Badge** - Visual feedback (Granted/Denied/Default)
- **Gradient Icons** - Beautiful, distinctive colors

### **On Access Control View:**
- **Back Button** - Return to grants view
- **Context Banner** - Shows which emulator (if from grants)
- **Badge on Tab** - Shows emulator name
- **Pre-selection** - Emulator auto-selected

### **Automatic Features:**
- **Auto-save** - All changes save instantly
- **URL Parameters** - Maintains state in URL
- **Responsive** - Works on all screen sizes

---

## ğŸ“‹ Admin Checklist

### **Initial Setup:**
1. â˜ Run Moodle upgrade to create database tables
2. â˜ Verify tables exist in phpMyAdmin
3. â˜ Review default security settings (DENY ALL)
4. â˜ Plan which emulators each school needs

### **Per School Setup:**
1. â˜ Go to School Grants tab
2. â˜ Select the school
3. â˜ Grant necessary emulators (toggle ON)
4. â˜ For each emulator:
   - â˜ Click "Access Control" button
   - â˜ Configure school-wide access
   - â˜ Set teacher selections
   - â˜ Set cohort permissions
   - â˜ Click "Back to School Grants"
5. â˜ Repeat for next school

### **Testing:**
1. â˜ Login as school manager
2. â˜ Verify only granted emulators visible
3. â˜ Test teacher access
4. â˜ Test student access
5. â˜ Verify cohort restrictions work

---

## ğŸ†˜ Troubleshooting

### **"Access Control button not working"**
- Check browser console for JavaScript errors
- Verify you're on the latest version
- Clear browser cache and refresh

### **"Emulator not pre-selected in Access Control"**
- Check URL parameters include `?view=access&emulator=code_editor&companyid=123`
- Verify emulator slug matches catalog definition

### **"Back button doesn't preserve school selection"**
- URL should include `companyid` parameter
- Check if school ID is valid

---

## ğŸ“ Support

For issues or questions, see:
- `EMULATOR_SCHOOL_GRANTS_SETUP.md` - Complete setup guide
- `TEACHER_EMULATOR_ACCESS_SETUP.md` - Teacher selection guide
- `SECURITY_MODEL_DENY_ALL.md` - Security model documentation

---

## ğŸ‰ Summary

The new workflow provides:
- **Quick Access** - Toggle switches for fast grants
- **Deep Control** - Access Control button for fine-tuning
- **Seamless Navigation** - Easy movement between views
- **Context Awareness** - System remembers your selections
- **Professional UX** - Smooth, intuitive interface

Perfect for managing emulator access across many schools! ğŸš€

